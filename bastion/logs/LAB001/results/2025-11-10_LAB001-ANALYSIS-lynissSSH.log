| Field                  | Description                                                            |
| ---------------------- | ---------------------------------------------------------------------- |
| **Artifact ID:**       | OBS-LAB001-2                                                           |
| **Description:**       | Analysis of system modifications on bastion host                       |
| **Related Lab:**       | LAB001 â€” *lab-initialization*                                          |
| **Date Analyzed:**     | 2025-11-12                                                             |
| **Analyst:**           | Jessie Moe                                                             |
| **Source System:**     | bastion                                                                |
| **Primary Logs Used:** | 2025-11-08_lynis.log | 2025-11-08_lynis-report.data.log                |
| **Category:**          | Audit |																  |
| **Severity:**          | Critical |                                                             |
--- 
2025-11-08 08:07:22 Set option to default value: NTPD_ROLE --> client
2025-11-08 08:07:22 Upgrade test skipped due profile option set (skip_upgrade_test)
2025-11-08 08:07:26 Performing test ID KRNL-5677 (Check CPU options and support)
2025-11-08 08:07:26 Test: Checking CPU options (XD/NX/PAE)
2025-11-08 08:07:26 Result: PAE or No eXecute option(s) both found
2025-11-08 08:07:26 Result: found default option (0), no execute only program or program with changed privilege levels can dump
2025-11-08 08:07:27 Test: Checking SHA_CRYPT_{MIN,MAX}_ROUNDS option in /etc/login.defs
2025-11-08 08:07:27 Result: File has no configuration options defined (empty, or only filled with comments and empty lines)
2025-11-08 08:07:27 Test: Checking PASS_MIN_DAYS option in /etc/login.defs
2025-11-08 08:07:27 Test: Checking PASS_MAX_DAYS option in /etc/login.defs 
2025-11-08 08:07:27 Result: option set, password is needed at single user mode boot
2025-11-08 08:07:27 Test: Checking FAILLOG_ENAB option in /etc/login.defs 
2025-11-08 08:07:28 Performing test ID FILE-6336 (Checking swap mount options)
2025-11-08 08:07:28 Test: check swap partitions with incorrect mount options
2025-11-08 08:07:28 Result: all swap partitions have correct options (sw or swap)
2025-11-08 08:07:28 Performing test ID FILE-6344 (Checking proc mount options)
2025-11-08 08:07:28 Test: check proc mount with incorrect mount options
2025-11-08 08:07:28 Result: /proc filesystem is not mounted with option hidepid=1 or hidepid=2
2025-11-08 08:07:28 Test: Checking acl option on ext[2-4] root file system
2025-11-08 08:07:28 Test: Checking default options on /dev/sda1
2025-11-08 08:07:28 Result: found ACL option in default mount options
2025-11-08 08:07:28 Test: Checking acl option on xfs root file system
2025-11-08 08:07:28 Result: ACL option enabled on root file system
2025-11-08 08:07:28 Performing test ID FILE-6372 (Checking / mount options)
2025-11-08 08:07:28 Result: mount system / is configured with options: errors=remount-ro
2025-11-08 08:07:28 Performing test ID FILE-6374 (Linux mount options)
2025-11-08 08:07:28 Result: Could not find mount option noexec on file system /dev
2025-11-08 08:07:28 Result: GOOD, found mount option nosuid on file system /dev
2025-11-08 08:07:28 Result: GOOD, found mount option nosuid on file system /dev/shm
2025-11-08 08:07:28 Result: GOOD, found mount option nodev on file system /dev/shm
2025-11-08 08:07:28 Result: Could not find mount option noexec on file system /dev/shm
2025-11-08 08:07:28 Result: GOOD, found mount option nodev on file system /run
2025-11-08 08:07:28 Result: GOOD, found mount option nosuid on file system /run
2025-11-08 08:07:28 Result: GOOD, found mount option nodev on file system /tmp
2025-11-08 08:07:28 Result: Could not find mount option noexec on file system /tmp
2025-11-08 08:07:28 Result: GOOD, found mount option nosuid on file system /tmp
2025-11-08 08:07:28 Result: Could not find mount option nodev on file system /var
2025-11-08 08:07:28 Result: Could not find mount option nosuid on file system /var
2025-11-08 08:07:28 Result: marked /var options as default (not hardened)
2025-11-08 08:07:28 Result: no mount point /var/tmp or expected options found
2025-11-08 08:07:28 Performing test ID NAME-4020 (Check non default options)
2025-11-08 08:07:28 Test: check /etc/resolv.conf for non default options
2025-11-08 08:07:28 Result: no specific other options configured in /etc/resolv.conf
2025-11-08 08:07:28 Skipped test PKGS-7314 (Checking pacman configuration options)
2025-11-08 08:07:32 Skipped test MAIL-8804 (Exim configuration options)
2025-11-08 08:07:32 Performing test ID SSH-7408 (Check SSH specific defined options)
2025-11-08 08:07:32 Test: Checking specific defined options in /tmp/lynis.ex2wgTc3cw
2025-11-08 08:07:32 Result: OpenSSH option AllowTcpForwarding is in a weak configuration state and should be fixed
2025-11-08 08:07:32 Result: OpenSSH option ClientAliveCountMax is configured reasonably
2025-11-08 08:07:32 Result: OpenSSH option ClientAliveInterval is configured very well
2025-11-08 08:07:32 Result: OpenSSH option FingerprintHash is configured very well
2025-11-08 08:07:32 Result: OpenSSH option GatewayPorts is configured very well
2025-11-08 08:07:32 Result: OpenSSH option IgnoreRhosts is configured very well
2025-11-08 08:07:32 Result: OpenSSH option LoginGraceTime is configured very well
2025-11-08 08:07:32 Result: OpenSSH option LogLevel is configured reasonably
2025-11-08 08:07:32 Result: OpenSSH option MaxAuthTries is configured reasonably
2025-11-08 08:07:32 Result: OpenSSH option MaxSessions is in a weak configuration state and should be fixed
2025-11-08 08:07:32 Result: OpenSSH option PermitRootLogin is configured very well
2025-11-08 08:07:32 Result: OpenSSH option PermitUserEnvironment is configured very well
2025-11-08 08:07:32 Result: OpenSSH option PermitTunnel is configured very well
2025-11-08 08:07:32 Result: OpenSSH option Port is in a weak configuration state and should be fixed
2025-11-08 08:07:32 Result: OpenSSH option PrintLastLog is configured very well
2025-11-08 08:07:32 Result: OpenSSH option StrictModes is configured very well
2025-11-08 08:07:32 Result: OpenSSH option TCPKeepAlive is in a weak configuration state and should be fixed
2025-11-08 08:07:32 Result: OpenSSH option UseDNS is configured very well
2025-11-08 08:07:32 Result: OpenSSH option X11Forwarding is in a weak configuration state and should be fixed
2025-11-08 08:07:32 Result: OpenSSH option AllowAgentForwarding is in a weak configuration state and should be fixed
2025-11-08 08:07:32 Performing test ID SSH-7440 (Check OpenSSH option: AllowUsers and AllowGroups)
2025-11-08 08:07:33 Skipped test DBS-1884 (Redis: requirepass option configured)
2025-11-08 08:07:33 Skipped test PHP-2368 (Check PHP register_globals option)
2025-11-08 08:07:33 Skipped test PHP-2372 (Check PHP expose_php option)
2025-11-08 08:07:33 Skipped test PHP-2374 (Check PHP enable_dl option)
2025-11-08 08:07:33 Skipped test PHP-2376 (Check PHP allow_url_fopen option)
2025-11-08 08:07:33 Skipped test PHP-2378 (Check PHP allow_url_include option)
2025-11-08 08:07:33 Skipped test PHP-2382 (Check PHP expose_php option)
2025-11-08 08:07:33 Skipped test SQD-3630 (Check Squid reply_body_max_size option)
2025-11-08 08:07:39 Result: key net.inet.ip.process_options does not exist on this machine

suggestion[]=LYNIS|This release is more than 4 months old. Check the website or GitHub to see if there is an update available.|-|-|
suggestion[]=DEB-0280|Install libpam-tmpdir to set $TMP and $TMPDIR for PAM sessions|-|-|
suggestion[]=DEB-0810|Install apt-listbugs to display a list of critical bugs prior to each APT installation.|-|-|
suggestion[]=DEB-0831|Install needrestart, alternatively to debian-goodies, so that you can run needrestart after upgrades to determine which daemons are using old versions of libraries and need restarting.|-|-|
suggestion[]=DEB-0880|Copy /etc/fail2ban/jail.conf to jail.local to prevent it being changed by updates.|-|-|
suggestion[]=BOOT-5122|Set a password on GRUB boot loader to prevent altering boot configuration (e.g. boot in single user mode without password)|-|-|
suggestion[]=BOOT-5180|Determine runlevel and services at startup|-|-|
suggestion[]=BOOT-5264|Consider hardening system services|Run '/usr/bin/systemd-analyze security SERVICE' for each service|-|
suggestion[]=AUTH-9230|Configure password hashing rounds in /etc/login.defs|-|-|
suggestion[]=AUTH-9262|Install a PAM module for password strength testing like pam_cracklib or pam_passwdqc or libpam-passwdqc|-|-|
suggestion[]=AUTH-9282|When possible set expire dates for all password protected accounts|-|-|
suggestion[]=AUTH-9286|Configure minimum password age in /etc/login.defs|-|-|
suggestion[]=AUTH-9286|Configure maximum password age in /etc/login.defs|-|-|
suggestion[]=AUTH-9328|Default umask in /etc/login.defs could not be found and defaults usually to 022, which could be more strict like 027|-|-|
suggestion[]=FILE-6310|To decrease the impact of a full /home file system, place /home on a separate partition|-|-|
suggestion[]=USB-1000|Disable drivers like USB storage when not used, to prevent unauthorized storage or data theft|-|-|
suggestion[]=STRG-1846|Disable drivers like firewire storage when not used, to prevent unauthorized storage or data theft|-|-|
suggestion[]=NAME-4028|Check DNS configuration for the dns domain name|-|-|
suggestion[]=PKGS-7370|Install debsums utility for the verification of packages with known good database.|-|-|
suggestion[]=PKGS-7394|Install package apt-show-versions for patch management purposes|-|-|
suggestion[]=PKGS-7420|Consider using a tool to automatically apply upgrades|-|-|
suggestion[]=NETW-3200|Determine if protocol 'dccp' is really needed on this system|-|-|
suggestion[]=NETW-3200|Determine if protocol 'sctp' is really needed on this system|-|-|
suggestion[]=NETW-3200|Determine if protocol 'rds' is really needed on this system|-|-|
suggestion[]=NETW-3200|Determine if protocol 'tipc' is really needed on this system|-|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|AllowTcpForwarding (set YES to NO)|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|ClientAliveCountMax (set 3 to 2)|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|LogLevel (set INFO to VERBOSE)|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|MaxAuthTries (set 6 to 3)|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|MaxSessions (set 10 to 2)|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|Port (set 22 to )|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|TCPKeepAlive (set YES to NO)|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|X11Forwarding (set YES to NO)|-|
suggestion[]=SSH-7408|Consider hardening SSH configuration|AllowAgentForwarding (set YES to NO)|-|
suggestion[]=LOGG-2154|Enable logging to an external logging host for archiving purposes and additional protection|-|-|
suggestion[]=BANN-7126|Add a legal banner to /etc/issue, to warn unauthorized users|-|-|
suggestion[]=BANN-7130|Add legal banner to /etc/issue.net, to warn unauthorized users|-|-|
suggestion[]=ACCT-9622|Enable process accounting|-|-|
suggestion[]=ACCT-9626|Enable sysstat to collect accounting (no results)|-|-|
suggestion[]=ACCT-9630|Audit daemon is enabled with an empty ruleset. Disable the daemon or define rules|-|-|
suggestion[]=FINT-4350|Install a file integrity tool to monitor changes to critical and sensitive files|-|-|
suggestion[]=TOOL-5002|Determine if automation tools are present for system management|-|-|
suggestion[]=FILE-7524|Consider restricting file permissions|See screen output or log file|text:Use chmod to change file permissions|
suggestion[]=KRNL-6000|One or more sysctl values differ from the scan profile and could be tweaked||Change sysctl value or disable test (skip-test=KRNL-6000:<sysctl-key>)|
suggestion[]=HRDN-7230|Harden the system by installing at least one malware scanner, to perform periodic file system scans|-|Install a tool like rkhunter, chkrootkit, OSSEC, Wazuh|
